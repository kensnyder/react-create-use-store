var t=require("react"),n=1;exports.createStore=function(t){var e=t.state;void 0===e&&(e={});var r=t.actions;void 0===r&&(r={});var o=t.autoReset;void 0===o&&(o=!1);var u=t.onFirstUse;void 0===u&&(u=function(){});var a=t.afterFirstMount;void 0===a&&(a=function(){});var i=t.afterEachMount;void 0===i&&(i=function(){});var s=t.afterEachUnmount;void 0===s&&(s=function(){});var c=t.afterLastUnmount;void 0===c&&(c=function(){});var f=t.id;void 0===f&&(f=null);var v=[],d=[],h={reset:function(){return l(e)},addActions:b,state:e,setState:l,nextState:function(){return new Promise(function(t){d.push(t)})},actions:{},id:String(f||"store-"+n),idx:n++,_subscribe:function(t){0==h._usedCount++&&u([h.state,l]),0===v.length&&a([h.state,l]),-1===v.indexOf(t)&&(v.push(t),i([h.state,l]))},_unsubscribe:function(t){v=v.filter(function(n){return n!==t}),s([h.state,l]),0===v.length&&(o&&h.reset(),c([h.state,l]))},_usedCount:0};return b(r),h;function b(t){Object.keys(t).forEach(function(n){var e=t[n];h.actions[n]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e.apply(void 0,[[h.state,l]].concat(t))}})}function l(t){"function"==typeof t&&(t=t(h.state)),Promise.resolve().then(function(){h.state=t,v.forEach(function(t){return t(h.state)}),d.forEach(function(t){return t(h.state)}),d=[]}).catch(function(t){throw t})}},exports.useStore=function(n){var e=t.useState(n.state)[1];return t.useDebugValue(n),t.useEffect(function(){return n._subscribe(e),function(){return n._unsubscribe(e)}},[n]),{state:n.state,actions:n.actions,reset:n.reset,nextState:n.nextState}};
//# sourceMappingURL=index.js.map
